<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <link href="kendo/styles/kendo.mobile.all.min.css" rel="stylesheet" />
    <link href="styles/main.css" rel="stylesheet" />
    
    <script src="cordova.js"></script>
    <script src="kendo/js/jquery.min.js"></script>
    <script src="kendo/js/kendo.mobile.min.js"></script>

    <!--script src="scripts/app.js"></script-->
    <script src="scripts/Comm.js"></script>
	<script src="scripts/Business.js"></script>
        <script src="scripts/Report.js"></script>
	<script src="scripts/Storage.js"></script>
    <script src="scripts/Log.js"></script>
</head>
<body>
 
  <div data-role="layout" data-id="main">
    <div data-role="header">
      <div data-role="navbar">
        <span data-role="view-title"></span>
        <a data-role="button" href="#appDrawer" data-rel="drawer" data-align="left" data-icon="drawer-button"></a>
      </div>
    </div>

    <!-- application views will be rendered here -->
    
  </div>
<div data-role="view">
    app
    </div>
  <!-- application drawer and contents -->
  <div data-role="drawer" id="appDrawer" style="width: 270px" data-title="Navigation">
    <div data-role="header">
      <div data-role="navbar">
        <span data-role="view-title"></span>
      </div>
    </div>
    <ul data-role="listview">
      <li>
        <a href="views/home.html">Home</a>
      </li>
      <li>
        <a href="views/settings.html">Settings</a>
      </li>
      <li>
        <a href="views/contacts.html">Contacts</a>
      </li>
    </ul>
  </div>       
<script>
    window.app = new kendo.mobile.Application($(document.body), {
        	platform: "ios7",
        layout : "home"});
         document.addEventListener("deviceready", function(){
             	Comm.init({
                    url: "http://localhost:8080/fiveleva/",
                    dataCallback: function(){
                        return {password: Business._password, appVersion: 1};
                	},
                    onCommError: function(error){
                        Business.showAlert(error);
                    },
                    hideLoading: function(){
                        Business.hideLoading();
                    },
                    onError: function(error){
                        Log.i("Server responded with error "+error);
                    	Business.showAlert(error);
                	}, 
                    checkIfRegistered: Business._checkIfRegistered
                    //type: "requestBody"
                });
                Storage.init({complete: function(){Business.login();}});
             /* Beacon.init({onInit: function(){},
                error: function(err){}, onFound: function(storeNumber){
                    UI.showAlert("Found store number "+storeNumber);
            }});
                Push.init({
                    onToken: function(token){
                        Log.i("On token" +token);
                        //Business._sendPushToken();
                        Log.i("Login is complete and token is sent");
                    },
                    onBackground: function(message, data) {
                        Business.openViewOnNotification(data);
                        for (key in data) {
                            Log.i(key + ": " + data[key]);
                        }
                        Log.i("Got message from background " + message);
                    },
                    onForeground: function(message, data) {
                        Business.openViewOnNotification(data);
                        for (key in data) {
                            Log.i(key + ": " + data[key]);
                        }
                        Log.i("Got message from foreground " + message);
                    },
                    onError: function(message) {
                        Log.i("Got PUSH error " + message);
                    }
                });*/
            },false);
                
</script>
</body>
</html>
